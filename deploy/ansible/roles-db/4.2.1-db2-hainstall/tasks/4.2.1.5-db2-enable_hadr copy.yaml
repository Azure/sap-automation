
---
####################  Activate Secondary  DB  as Standby at DB level  #########################
- name:                                      "DB2 - Activate HADR on Secondary DB "
  become:                                     true
  become_user:                            db2{{ db_sid | lower }}
  block:
    - name:                                      "DB2 Secondary DB - Activate Secondary as standby "
      ansible.builtin.shell: |
        db2 deactivate database {{ db_sid | lower }}
        db2 start hadr on database {{ db_sid }} as standby

      args:
        executable: /bin/csh
      environment:
        PATH: "{{ ansible_env.PATH }}:/db2/db2{{ db_sid | lower }}/sqllib/gskit/bin"
  when:                    
    - ansible_hostname == secondary_instance_name

####################  Activate Primary  DB  as primary at DB level  #########################

- name:                                      "DB2 - Activate HADR on Primary DB"
  become:                                     true
  become_user:                            db2{{ db_sid | lower }}
  block:
    - name:                                      "DB2 Secondary DB - Activate Secondary as standby "
      ansible.builtin.shell: |
        db2 deactivate database {{ db_sid | lower }}
        db2 start hadr on database {{ db_sid }} as primary

      args:
        executable: /bin/csh
      environment:
        PATH: "{{ ansible_env.PATH }}:/db2/db2{{ db_sid | lower }}/sqllib/gskit/bin"
  when:                    
    - ansible_hostname == primary_instance_name

#################### End of Section for Primary DB   ######################





