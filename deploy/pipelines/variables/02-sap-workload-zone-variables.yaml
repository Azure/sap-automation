# Copyright (c) Microsoft Corporation.
# Licensed under the MIT License.

#--------------------------------------+---------------------------------------8
#                                                                              |
# Defines the parameters and variables for the SAP Workload Zone               |
#                                                                              |
#--------------------------------------+---------------------------------------8

parameters:
  - name:                              workload_zone
    displayName:                       "Workload zone configuration name, use the following syntax: ENV-LOCA-VNET-INFRASTRUCTURE"
    type:                              string
    default:                           DEV-WEEU-SAP01-INFRASTRUCTURE

  - name:                              workload_environment
    displayName:                       "Workload zone configuration name, use the following syntax: ENV-LOCA-VNET"
    type:                              string
    default:                           DEV-WEEU-SAP01

  - name:                              deployer_environment
    displayName:                       Deployer Environment name (MGMT, DEV, QA, PRD, ...)
    type:                              string
    default:                           MGMT

  - name:                              deployer_region
    displayName:                       Deployer region name code (MGMT, DEV, QA, PRD, ...)
    type:                              string
    default:                           WEEU
    values:
      - AUCE
      - AUC2
      - AUEA
      - AUSE
      - BRSO
      - BRSE
      - BRUS
      - CACE
      - CAEA
      - CEIN
      - CEUS
      - CEUA
      - EAAS
      - EAUS
      - EUSA
      - EUS2
      - FRCE
      - FRSO
      - GENO
      - GEWC
      - JAEA
      - JAWE
      - JINC
      - JINW
      - KOCE
      - KOSO
      - NCUS
      - NOEU
      - NOEA
      - NOWE
      - NZNO
      - SANO
      - SAWE
      - SCUS
      - SCUG
      - SOEA
      - SOIN
      - SECE
      - SWNO
      - SWWE
      - UACE
      - UANO
      - UKSO
      - UKWE
      - WCUS
      - WEEU
      - WEIN
      - WEUS
      - WUS2
      - WUS3

  - name:                              inherit_settings
    displayName:                       Inherit Terraform state file information from control plane
    type:                              boolean
    default:                           true

  - name:                              test
    displayName:                       Test only
    type:                              boolean
    default:                           false

variables:
  - group:                             "SDAF-General"

  - group:                             SDAF-${{ replace(parameters.workload_environment, '-INFRASTRUCTURE', '') }}

  - name:                              parent_variable_group
    value:                             SDAF-${{ parameters.deployer_environment }}

  - name:                              variable_group
    value:                             SDAF-${{ replace(parameters.workload_environment, '-INFRASTRUCTURE', '') }}

  - name:                              workload_zone_foldername
    value:                             ${{ iif(contains(parameters.workload_zone, '-INFRASTRUCTURE'),parameters.workload_zone, format('{0}-{1}', parameters.workload_zone, 'INFRASTRUCTURE')) }}

  - name:                              workload_zone_tfvars_filename
    value:                             ${{ iif(contains(parameters.workload_zone, '-INFRASTRUCTURE'),format('{0}.tfvars', parameters.workload_zone), format('{0}-{1}.tfvars', parameters.workload_zone, 'INFRASTRUCTURE')) }}

  - name:                              deployer_environment
    value:                             ${{ parameters.deployer_environment }}

  - name:                              deployer_region
    value:                             ${{ parameters.deployer_region }}

  - name:                              inherit
    value:                             $[lower(${{ parameters.inherit_settings }})]

  - name:                              tf_url
    value:                             https://releases.hashicorp.com/terraform/$(tf_version)/terraform_$(tf_version)_linux_amd64.zip

  - name:                              this_agent
    value:                             $[lower(coalesce(variables['POOL'], variables['AGENT']))]

  - name:                              test
    value:                             ${{ parameters.test }}

  - name:                              control_plane_name
    value:                             ${{ upper(replace(parameters.deployer_environment, '-INFRASTRUCTURE', '') ) }}

  - name:                              workload_zone_name
    value:                             ${{ upper(replace(parameters.workload_environment, '-INFRASTRUCTURE', '') ) }}
